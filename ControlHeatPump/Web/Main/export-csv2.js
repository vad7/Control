/**
 * A Highcharts plugin for exporting data from a rendered chart as CSV, XLS or HTML table
 * Licence:  MIT
 * Version:  1.4.8 (without view data)
 */
!function(e){"object"==typeof module&&module.exports?module.exports=e:e(Highcharts)}(function(y){"use strict";var w=y.each,b=y.pick,e=y.seriesTypes,l=void 0!==document.createElement("a").download;function o(e,t,o,n,i){var a,r,s,c=((e.options.exporting||{}).csv||{}).url||"http://www.highcharts.com/studies/csv-export/download.php";s=e.options.exporting.filename?e.options.exporting.filename:e.title?e.title.textStr.replace(/ /g,"-").toLowerCase():"chart",window.Blob&&window.navigator.msSaveOrOpenBlob?(r=new Blob([n]),window.navigator.msSaveOrOpenBlob(r,s+"."+o)):l?((a=document.createElement("a")).href=t,a.download=s+"."+o,e.container.append(a),a.click(),a.remove()):y.post(c,{data:n,type:i,extension:o})}y.setOptions({lang:{downloadCSV:"Download CSV",downloadXLS:"Download XLS"}}),y.Chart.prototype.getDataRows=function(){var o,e,m,t,n,i,a,r=(this.options.exporting||{}).csv||{},d=this.xAxis,u={},s=[],h=[],c=r.dateFormat||"%Y-%m-%d %H:%M:%S",f=r.columnHeaderFormatter||function(e,t,o){return e instanceof y.Axis?e.options.title&&e.options.title.text||(e.isDatetimeAxis?"DateTime":"Category"):e?e.name+(1<o?" ("+t+")":""):"Category"},g=[];for(t in m=0,w(this.series,function(a){var r,s=a.options.keys||a.pointArrayMap||["y"],c=s.length,l=a.requireSorting,p={},x=y.inArray(a.xAxis,d);if(w(s,function(e){p[e]=a[e+"Axis"]&&a[e+"Axis"].categories||[]}),!1!==a.options.includeInCSVExport&&!1!==a.visible){for(y.find(g,function(e){return e[0]===x})||g.push([x,m]),r=0;r<c;)h.push(f(a,s[r],s.length)),r+=1;w(a.points,function(e,t){var o,n,i=l?e.x:t;for(r=0,u[i]||(u[i]=[],u[i].xValues=[]),u[i].x=e.x,u[i].xValues[x]=e.x,a.xAxis&&"name"!==a.exportKey||(u[i].name=e.name);r<c;)n=e[o=s[r]],u[i][m+r]=b(p[o][n],n),r+=1}),m+=r}}),u)u.hasOwnProperty(t)&&s.push(u[t]);for(e=[h],m=g.length;m--;)i=g[m][0],a=g[m][1],o=d[i],s.sort(function(e,t){return e.xValues[i]-t.xValues[i]}),n=f(o),e[0].splice(a,0,n),w(s,function(e){var t=e.name;t=t||(o.isDatetimeAxis?(e.x instanceof Date&&(e.x=e.x.getTime()),y.dateFormat(c,e.x)):o.categories?b(o.names[e.x],o.categories[e.x],e.x):e.x),e.splice(a,0,t)});return e=e.concat(s)},y.Chart.prototype.getCSV=function(a){var r="",s=this.getDataRows(),e=(this.options.exporting||{}).csv||{},c=e.itemDelimiter||",",l=e.lineDelimiter||"\n";return w(s,function(e,t){for(var o="",n=e.length,i=a?1.1.toLocaleString()[1]:".";n--;)"string"==typeof(o=e[n])&&(o='"'+o+'"'),"number"==typeof o&&","===i&&(o=o.toString().replace(".",",")),e[n]=o;r+=e.join(c),t<s.length-1&&(r+=l)}),r},y.Chart.prototype.getTable=function(r){var s="<table><thead>",e=this.getDataRows();return w(e,function(e,t){var o,n,i=t?"td":"th",a=r?1.1.toLocaleString()[1]:".";for(s+="<tr>",n=0;n<e.length;n+=1)"number"==typeof(o=e[n])?(o=o.toString(),","===a&&(o=o.replace(".",a)),s+="<"+i+' class="number">'+o+"</"+i+">"):s+="<"+i+">"+(void 0===o?"":o)+"</"+i+">";s+="</tr>",t||(s+="</thead><tbody>")}),s+="</tbody></table>"},y.Chart.prototype.downloadCSV=function(){var e=this.getCSV(!0);o(this,"data:text/csv,\ufeff"+encodeURIComponent(e),"csv",e,"text/csv")},y.Chart.prototype.downloadXLS=function(){var e,t='<html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel" xmlns="http://www.w3.org/TR/REC-html40"><head>\x3c!--[if gte mso 9]><xml><x:ExcelWorkbook><x:ExcelWorksheets><x:ExcelWorksheet><x:Name>Ark1</x:Name><x:WorksheetOptions><x:DisplayGridlines/></x:WorksheetOptions></x:ExcelWorksheet></x:ExcelWorksheets></x:ExcelWorkbook></xml><![endif]--\x3e<style>td{border:none;font-family: Calibri, sans-serif;} .number{mso-number-format:"0.00";}</style><meta name=ProgId content=Excel.Sheet><meta charset=UTF-8></head><body>'+this.getTable(!0)+"</body></html>";o(this,"data:application/vnd.ms-excel;base64,"+(e=t,window.btoa(unescape(encodeURIComponent(e)))),"xls",t,"application/vnd.ms-excel")},y.getOptions().exporting&&y.getOptions().exporting.buttons.contextButton.menuItems.push({textKey:"downloadCSV",onclick:function(){this.downloadCSV()}},{textKey:"downloadXLS",onclick:function(){this.downloadXLS()}}),e.map&&(e.map.prototype.exportKey="name"),e.mapbubble&&(e.mapbubble.prototype.exportKey="name"),e.treemap&&(e.treemap.prototype.exportKey="name")});