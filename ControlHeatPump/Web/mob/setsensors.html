<!DOCTYPE HTML>

<html>
	<head>
		<title>НАРОДНЫЙ КОНТРОЛЛЕР</title>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1" />
		<meta http-equiv="Content-Style-Type" content="text/css">
        <link rel="stylesheet" type="text/css" href="assets/css/main.css">
		<!-- Scripts -->
<script type="text/javascript" src="assets/js/jquery.min.js"></script>
<script type="text/javascript" src="highcharts.js"></script>
<script type="text/javascript" src="exporting.js"></script>
<script type='text/javascript' src='scripts1.js'></script>
<script type="text/javascript">
		window.onload = function() {
		loadParam("get_OneWirePin,get_nTemp(TEVAING),get_nTemp(TEVAOUTG),get_nTemp(TCONING),get_nTemp(TCONOUTG),get_nTemp(TOUT),get_nTemp(TIN),get_nTemp(TEVAIN),get_nTemp(TEVAOUT),get_nTemp(TCONIN),get_nTemp(TCONOUT),get_nTemp(TBOILER),get_nTemp(TACCUM),get_nTemp(TRTOOUT),get_nTemp(TCOMP),get_presentTemp(TEVAING),get_presentTemp(TEVAOUTG),get_presentTemp(TCONING),get_presentTemp(TCONOUTG),get_presentTemp(TOUT),get_presentTemp(TIN),get_presentTemp(TEVAIN),get_presentTemp(TEVAOUT),get_presentTemp(TCONIN),get_presentTemp(TCONOUT),get_presentTemp(TBOILER),get_presentTemp(TACCUM),get_presentTemp(TRTOOUT),get_presentTemp(TCOMP)");
		loadParam("get_WORK");
		loadParam("get_adressTemp(TEVAING),get_adressTemp(TEVAOUTG),get_adressTemp(TCONING),get_adressTemp(TCONOUTG),get_adressTemp(TOUT),get_adressTemp(TIN),get_adressTemp(TEVAIN),get_adressTemp(TEVAOUT),get_adressTemp(TCONIN),get_adressTemp(TCONOUT),get_adressTemp(TBOILER),get_adressTemp(TACCUM),get_adressTemp(TRTOOUT),get_adressTemp(TCOMP),get_errcodeTemp(TEVAING),get_errcodeTemp(TEVAOUTG),get_errcodeTemp(TCONING),get_errcodeTemp(TCONOUTG),get_errcodeTemp(TOUT),get_errcodeTemp(TIN),get_errcodeTemp(TEVAIN),get_errcodeTemp(TEVAOUT),get_errcodeTemp(TCONIN),get_errcodeTemp(TCONOUT),get_errcodeTemp(TBOILER),get_errcodeTemp(TACCUM),get_errcodeTemp(TRTOOUT),get_errcodeTemp(TCOMP)");
		updateParam("get_rawTemp(TEVAING),get_rawTemp(TEVAOUTG),get_rawTemp(TCONING),get_rawTemp(TCONOUTG),get_rawTemp(TIN),get_rawTemp(TOUT),get_rawTemp(TEVAIN),get_rawTemp(TEVAOUT),get_rawTemp(TCONIN),get_rawTemp(TCONOUT),get_rawTemp(TBOILER),get_rawTemp(TACCUM),get_rawTemp(TRTOOUT),get_rawTemp(TCOMP)");
	};		 
		</script>

	</head>
	<body class="landing">
		<div id="page-wrapper">

			<!-- Header -->
				<header id="header">
					<h1 id="logo"><a href="index.html">КОНТРОЛЛЕР ТЕПЛОВОГО НАСОСА</a></h1>
					<nav id="nav">
				  <script src="menu.js"></script>
					</nav>
				</header>

			<!-- Banner -->
				<section id="banner">
			  <div class="content">
						<header>
							<h2>ПРИВЯЗКА ДАТЧИКОВ<br> ТЕМПЕРАТУРЫ</h2>
							<p> <br />							
					  </header>
                      
<div class="swich">
<h8><span id="get_work2"></span><br>
<span id="get_work3"></span></h8>
<span id="onoffswitch"></span>
<br>
<dd><span id="get_errcode" style="display:block">-</span></dd>
</div>  
                                     
<div class="table-wrapper">

<h4>Сканирование шины OneWire [ pin <span id="get_onewirepin"></span> ]</h4>
		<h6>ВНИМАНИЕ! Сканирование датчиков приводит к остановке теплового насоса!</h6><p></p>
        <button class="button special" id="scan" onclick='loadParam("scan_OneWire",true);'>Начать сканирование</button><p></p>
		<table>
		<thead>
		<tr>
			<th>Номер</th>
			<th>Тип</th>
			<th>Т °C</th>
			<th>Адрес</th>
		</tr>
		</thead>
		<tbody id="scan_onewire">
		<tr>
		</tr>
		</tbody>
		</table>            
 
 </div> 
                                     
<div class="table-wrapper">
<h4>Датчики системы</h4>
		
        <h55>Имя датчика TOUT</h55>        
        <table id="get_presenttemp-tout">        
		<tbody>
			<tr>
            <td>Описание</td>
            <td></td><td></td>
			<td id="get_ntemp-tout"></td>
            </tr>
            <tr>
            <td>Температура</td>
            <td></td><td></td>
			<td id="get_rawtemp-tout">-</td>
            </tr>
            <tr>
            <td>Адрес</td>
            <td></td><td></td>
            <td id="get_adresstemp-tout">-</td>
            </tr>
            <tr>
            <td>Привязка</td>
            <td></td><td></td>
			<td><select class="buttont" id="set_adresstemp-tout" onChange="setParam('set_adressTemp(TOUT)','get_adresstemp-tout');"> <option value="0">Привязать</option> </select></td>
            </tr>
            <tr>
            <td>Код ошибки</td>
            <td></td><td></td>
			<td id="get_errcodetemp-tout">-</td>
            </tr>
        </tbody>        
	</table>
        
    <h55>Имя датчика TIN</h55>
		<table id="get_presenttemp-tin">        
		<tbody>
            <tr>
            <td>Описание</td>
            <td></td><td></td>
			<td id="get_ntemp-tin"></td>
            </tr>
            <tr>
            <td>Температура</td>
            <td></td><td></td>
			<td id="get_rawtemp-tin">-</td>
            </tr>
            <tr>
            <td>Адрес</td>
            <td></td><td></td>
            <td id="get_adresstemp-tin">-</td>
            </tr>
            <tr>
            <td>Привязка</td>
            <td></td><td></td>
			<td><select class="buttont" id="set_adresstemp-tin" onChange="setParam('set_adressTemp(TIN)','get_adresstemp-tin');"><option value="0">Привязать</option></select></td>
            </tr>
            <tr>
            <td>Код ошибки</td>
            <td></td><td></td>
			<td id="get_errcodetemp-tin">-</td>
            </tr>
        </tbody>
	</table> 
    
    <h55>Имя датчика TEVAIN</h55>
		<table id="get_presenttemp-tevain">        
		<tbody>
            <tr>
            <td>Описание</td>
            <td></td><td></td>
			<td id="get_ntemp-tevain"></td>
            </tr>
            <tr>
            <td>Температура</td>
            <td></td><td></td>
			<td id="get_rawtemp-tevain">-</td>
            </tr>
            <tr>
            <td>Адрес</td>
            <td></td><td></td>
            <td id="get_adresstemp-tevain">-</td>
            </tr>
            <tr>
            <td>Привязка</td>
            <td></td><td></td>
			<td><select class="buttont" id="set_adresstemp-tevain" onChange="setParam('set_adressTemp(TEVAIN)','get_adresstemp-tevain');"><option value="0">Привязать</option></select></td>
            </tr>
            <tr>
            <td>Код ошибки</td>
            <td></td><td></td>
			<td id="get_errcodetemp-tevain">-</td>
            </tr>
        </tbody>
	</table> 
    
    <h55>Имя датчика TEVAOUT</h55>
		<table id="get_presenttemp-tevaout">        
		<tbody>
            <tr>
            <td>Описание</td>
            <td></td><td></td>
			<td id="get_ntemp-tevaout"></td>
            </tr>
            <tr>
            <td>Температура</td>
            <td></td><td></td>
			<td id="get_rawtemp-tevaout">-</td>
            </tr>
            <tr>
            <td>Адрес</td>
            <td></td><td></td>
            <td id="get_adresstemp-tevaout">-</td>
            </tr>
            <tr>
            <td>Привязка</td>
            <td></td><td></td>
			<td><select class="buttont" id="set_adresstemp-tevaout" onChange="setParam('set_adressTemp(TEVAOUT)','get_adresstemp-tevaout');"><option value="0">Привязать</option></select></td>
            </tr>
            <tr>
            <td>Код ошибки</td>
            <td></td><td></td>
			<td id="get_errcodetemp-tevaout">-</td>
            </tr>
        </tbody>
	</table>
    
    <h55>Имя датчика TCONIN</h55>
		<table id="get_presenttemp-tconin">        
		<tbody>
            <tr>
            <td>Описание</td>
            <td></td><td></td>
			<td id="get_ntemp-tconin"></td>
            </tr>
            <tr>
            <td>Температура</td>
            <td></td><td></td>
			<td id="get_rawtemp-tconin">-</td>
            </tr>
            <tr>
            <td>Адрес</td>
            <td></td><td></td>
            <td id="get_adresstemp-tconin">-</td>
            </tr>
            <tr>
            <td>Привязка</td>
            <td></td><td></td>
			<td><select class="buttont" id="set_adresstemp-tconin" onChange="setParam('set_adressTemp(TCONIN)','get_adresstemp-tconin');"><option value="0">Привязать</option></select></td>
            </tr>
            <tr>
            <td>Код ошибки</td>
            <td></td><td></td>
			<td id="get_errcodetemp-tconin">-</td>
            </tr>
        </tbody>
	</table>
    
    <h55>Имя датчика TCONOUT</h55>
		<table id="get_presenttemp-tconout">        
		<tbody>
            <tr>
            <td>Описание</td>
            <td></td><td></td>
			<td id="get_ntemp-tconout"></td>
            </tr>
            <tr>
            <td>Температура</td>
            <td></td><td></td>
			<td id="get_rawtemp-tconout">-</td>
            </tr>
            <tr>
            <td>Адрес</td>
            <td></td><td></td>
            <td id="get_adresstemp-tconout">-</td>
            </tr>
            <tr>
            <td>Привязка</td>
            <td></td><td></td>
			<td><select class="buttont" id="set_adresstemp-tconout" onChange="setParam('set_adressTemp(tconout)','get_adresstemp-tconout');"><option value="0">Привязать</option></select></td>
            </tr>
            <tr>
            <td>Код ошибки</td>
            <td></td><td></td>
			<td id="get_errcodetemp-tconout">-</td>
            </tr>
        </tbody>
	</table>
    
    <h55>Имя датчика TBOILER</h55>
		<table id="get_presenttemp-tboiler">        
		<tbody>
            <tr>
            <td>Описание</td>
            <td></td><td></td>
			<td id="get_ntemp-tboiler"></td>
            </tr>
            <tr>
            <td>Температура</td>
            <td></td><td></td>
			<td id="get_rawtemp-tboiler">-</td>
            </tr>
            <tr>
            <td>Адрес</td>
            <td></td><td></td>
            <td id="get_adresstemp-tboiler">-</td>
            </tr>
            <tr>
            <td>Привязка</td>
            <td></td><td></td>
			<td><select class="buttont" id="set_adresstemp-tboiler" onChange="setParam('set_adressTemp(tboiler)','get_adresstemp-tboiler');"><option value="0">Привязать</option></select></td>
            </tr>
            <tr>
            <td>Код ошибки</td>
            <td></td><td></td>
			<td id="get_errcodetemp-tboiler">-</td>
            </tr>
        </tbody>
	</table>
    
    <h55>Имя датчика TACCUM</h55>
		<table id="get_presenttemp-taccum">        
		<tbody>
            <tr>
            <td>Описание</td>
            <td></td><td></td>
			<td id="get_ntemp-taccum"></td>
            </tr>
            <tr>
            <td>Температура</td>
            <td></td><td></td>
			<td id="get_rawtemp-taccum">-</td>
            </tr>
            <tr>
            <td>Адрес</td>
            <td></td><td></td>
            <td id="get_adresstemp-taccum">-</td>
            </tr>
            <tr>
            <td>Привязка</td>
            <td></td><td></td>
			<td><select class="buttont" id="set_adresstemp-taccum" onChange="setParam('set_adressTemp(taccum)','get_adresstemp-taccum');"><option value="0">Привязать</option></select></td>
            </tr>
            <tr>
            <td>Код ошибки</td>
            <td></td><td></td>
			<td id="get_errcodetemp-taccum">-</td>
            </tr>
        </tbody>
	</table>
    
    <h55>Имя датчика TRTOOUT</h55>
		<table id="get_presenttemp-trtoout">        
		<tbody>
            <tr>
            <td>Описание</td>
            <td></td><td></td>
			<td id="get_ntemp-trtoout"></td>
            </tr>
            <tr>
            <td>Температура</td>
            <td></td><td></td>
			<td id="get_rawtemp-trtoout">-</td>
            </tr>
            <tr>
            <td>Адрес</td>
            <td></td><td></td>
            <td id="get_adresstemp-trtoout">-</td>
            </tr>
            <tr>
            <td>Привязка</td>
            <td></td><td></td>
			<td><select class="buttont" id="set_adresstemp-trtoout" onChange="setParam('set_adressTemp(trtoout)','get_adresstemp-trtoout');"><option value="0">Привязать</option></select></td>
            </tr>
            <tr>
            <td>Код ошибки</td>
            <td></td><td></td>
			<td id="get_errcodetemp-trtoout">-</td>
            </tr>
        </tbody>
	</table>
    
    <h55>Имя датчика TCOMP</h55>
		<table id="get_presenttemp-tcomp">        
		<tbody>
            <tr>
            <td>Описание</td>
            <td></td><td></td>
			<td id="get_ntemp-tcomp"></td>
            </tr>
            <tr>
            <td>Температура</td>
            <td></td><td></td>
			<td id="get_rawtemp-tcomp">-</td>
            </tr>
            <tr>
            <td>Адрес</td>
            <td></td><td></td>
            <td id="get_adresstemp-tcomp">-</td>
            </tr>
            <tr>
            <td>Привязка</td>
            <td></td><td></td>
			<td><select class="buttont" id="set_adresstemp-tcomp" onChange="setParam('set_adressTemp(tcomp)','get_adresstemp-tcomp');"><option value="0">Привязать</option></select></td>
            </tr>
            <tr>
            <td>Код ошибки</td>
            <td></td><td></td>
			<td id="get_errcodetemp-tcomp">-</td>
            </tr>
        </tbody>
	</table>
    
    <h55>Имя датчика TEVAING</h55>
		<table id="get_presenttemp-tevaing">        
		<tbody>
            <tr>
            <td>Описание</td>
            <td></td><td></td>
			<td id="get_ntemp-tevaing"></td>
            </tr>
            <tr>
            <td>Температура</td>
            <td></td><td></td>
			<td id="get_rawtemp-tevaing">-</td>
            </tr>
            <tr>
            <td>Адрес</td>
            <td></td><td></td>
            <td id="get_adresstemp-tevaing">-</td>
            </tr>
            <tr>
            <td>Привязка</td>
            <td></td><td></td>
			<td><select class="buttont" id="set_adresstemp-tevaing" onChange="setParam('set_adressTemp(tevaing)','get_adresstemp-tevaing');"><option value="0">Привязать</option></select></td>
            </tr>
            <tr>
            <td>Код ошибки</td>
            <td></td><td></td>
			<td id="get_errcodetemp-tevaing">-</td>
            </tr>
        </tbody>
	</table>
    
    <h55>Имя датчика TEVAOUTG</h55>
		<table id="get_presenttemp-tevaoutg">        
		<tbody>
            <tr>
            <td>Описание</td>
            <td></td><td></td>
			<td id="get_ntemp-tevaoutg"></td>
            </tr>
            <tr>
            <td>Температура</td>
            <td></td><td></td>
			<td id="get_rawtemp-tevaoutg">-</td>
            </tr>
            <tr>
            <td>Адрес</td>
            <td></td><td></td>
            <td id="get_adresstemp-tevaoutg">-</td>
            </tr>
            <tr>
            <td>Привязка</td>
            <td></td><td></td>
			<td><select class="buttont" id="set_adresstemp-tevaoutg" onChange="setParam('set_adressTemp(tevaoutg)','get_adresstemp-tevaoutg');"><option value="0">Привязать</option></select></td>
            </tr>
            <tr>
            <td>Код ошибки</td>
            <td></td><td></td>
			<td id="get_errcodetemp-tevaoutg">-</td>
            </tr>
        </tbody>
	</table>
    
    <h55>Имя датчика TCONING</h55>
		<table id="get_presenttemp-tconing">        
		<tbody>
            <tr>
            <td>Описание</td>
            <td></td><td></td>
			<td id="get_ntemp-tconing"></td>
            </tr>
            <tr>
            <td>Температура</td>
            <td></td><td></td>
			<td id="get_rawtemp-tconing">-</td>
            </tr>
            <tr>
            <td>Адрес</td>
            <td></td><td></td>
            <td id="get_adresstemp-tconing">-</td>
            </tr>
            <tr>
            <td>Привязка</td>
            <td></td><td></td>
			<td><select class="buttont" id="set_adresstemp-tconing" onChange="setParam('set_adressTemp(tconing)','get_adresstemp-tconing');"><option value="0">Привязать</option></select></td>
            </tr>
            <tr>
            <td>Код ошибки</td>
            <td></td><td></td>
			<td id="get_errcodetemp-tconing">-</td>
            </tr>
        </tbody>
	</table>
    
    <h55>Имя датчика TCONOUTG</h55>
		<table id="get_presenttemp-tconoutg">        
		<tbody>
            <tr>
            <td>Описание</td>
            <td></td><td></td>
			<td id="get_ntemp-tconoutg"></td>
            </tr>
            <tr>
            <td>Температура</td>
            <td></td><td></td>
			<td id="get_rawtemp-tconoutg">-</td>
            </tr>
            <tr>
            <td>Адрес</td>
            <td></td><td></td>
            <td id="get_adresstemp-tconoutg">-</td>
            </tr>
            <tr>
            <td>Привязка</td>
            <td></td><td></td>
			<td><select class="buttont" id="set_adresstemp-tconoutg" onChange="setParam('set_adressTemp(tconoutg)','get_adresstemp-tconoutg');"><option value="0">Привязать</option></select></td>
            </tr>
            <tr>
            <td>Код ошибки</td>
            <td></td><td></td>
			<td id="get_errcodetemp-tconoutg">-</td>
            </tr>
        </tbody>
	</table>
                       
</div>
</div>
<script>  
        function show()   
        {   
           	
			$.get(urlcontrol + '/&get_MODE&get_errcode&get_error&get_WORK&&', function(data) {
  				$('.result').html(data);
  					console.log(data);
					var oldString = (data); 
					var newString = oldString.replace("&&","\"}");
					newString = newString.replace("&get_","{\"");
					newString = newString.replace(/=/g,"\":\"");
					newString = newString.replace(/&get_/g,"\",\"");
					console.log(newString);
					var obj = JSON.parse(newString);
					console.log(obj);
					if(obj["WORK"] == "ON") {
						document.getElementById("get_work2").innerHTML = '<input class="button3 small" type="submit" value="" onClick="swich(\'onoffswitch\')" /><input type="submit" value="ТН включен. Выключить ТН?" onClick="swich(\'onoffswitch\')" class="button small" />';
						var element = document.getElementById("onoffswitch");
						if(!element) {
						document.getElementById(obj["WORK"].toLowerCase()).innerHTML = "ON";
						} else {
						document.getElementById("onoffswitch").checked = false;
						document.getElementById("get_work2").innerHTML = '<input class="button3 small" type="submit" value="" onClick="swich(\'onoffswitch\')" /><input type="submit" value="ТН включен. Выключить ТН?" onClick="swich(\'onoffswitch\')" class="button small" />';
						
										}
					} else if(obj["WORK"] == "OFF") {
						document.getElementById("get_work2").innerHTML = '<input class="button4 small" type="submit" value="" onClick="swich(\'onoffswitch\')" /><input type="submit" value="ТН выключен. Включить ТН?" onClick="swich(\'onoffswitch\')" class="button small" />';
						var element = document.getElementById("onoffswitch");
						if(!element) {
						document.getElementById(obj["WORK"].toLowerCase()).innerHTML = "OFF";
						} else {
						document.getElementById("onoffswitch").checked = true;
						document.getElementById("get_work2").innerHTML = '<input class="button4 small" type="submit" value="" onClick="swich(\'onoffswitch\')" /><input type="submit" value="ТН выключен. Включить ТН?" onClick="swich(\'onoffswitch\')" class="button small" />';
					}
					}
								
					if(obj["errcode"] == 0) {
					document.getElementById("get_errcode").innerHTML = obj["error"];
					document.getElementById("get_errcode").style.display = "none";
						} else if(obj["errcode"] < 0) {
						document.getElementById("get_errcode").innerHTML = obj["error"];}
	});
		} 
		$(document).ready(function(){   
            show();   
            setInterval('show()',3000);   
        });   
    </script> 
 
  <br>
 </div>                   

	    </section>


			<!-- Footer -->
				<footer id="footer">
					<ul class="icons">
						
					</ul>
					<ul class="copyright">
						
					</ul>
				</footer>

		</div>

			
	</body>
</html>